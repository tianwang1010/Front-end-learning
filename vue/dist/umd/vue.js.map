{"version":3,"file":"vue.js","sources":["../../src/observe/array.js","../../src/utils/index.js","../../src/observe/index.js","../../src/initState.js","../../src/init.js","../../src/index.js"],"sourcesContent":["\r\nlet oldArrayMethods = Array.prototype\r\nexport let arrayMethods = Object.create(oldArrayMethods)\r\n\r\nconst methods = [\r\n    'push',\r\n    'shift',\r\n    'unshift',\r\n    'pop',\r\n    'sort',\r\n    'splice',\r\n    'reverse'\r\n]\r\nmethods.forEach(method =>{\r\n    arrayMethods[method] = function(...args) { \r\n\r\n        const result = oldArrayMethods[method].apply(this,args)\r\n        let inserted\r\n        let ob = this.__ob__\r\n        switch(method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case 'splice':\r\n                inserted = args.slice(2)\r\n                default:break;\r\n        }\r\n        if(inserted) ob.observeArray(inserted)\r\n        return result\r\n    }\r\n})","export function isObject(data){\r\n    return typeof data === 'object' && data !== null\r\n}\r\nexport function def(data,key,value){\r\n    Object.defineProperty(data,key,{        \r\n            enumerable:false,\r\n            configurable:false,\r\n            value        \r\n    })\r\n}","// 使用Object.defineProperty 重新定义ES5\r\n\r\nimport { arrayMethods} from './array.js'\r\nimport {isObject, def} from '../utils/index.js'\r\nclass Observe{\r\n    constructor(value){\r\n        def(value, '__ob__', this)\r\n        if(Array.isArray(value)){\r\n            // 对数组的方法进行劫持 重写\r\n            value.__proto__ = arrayMethods\r\n            // 如果数组里面放的是对象在监控 \r\n            this.observeArray(value)\r\n        }else{\r\n            this.walk(value)\r\n        }\r\n      \r\n    }\r\n    observeArray(value){\r\n        for(let i = 0; i < value.length; i++){\r\n            observe(value[i])\r\n        }\r\n    }\r\n    walk(data){\r\n       let keys =  Object.keys(data)\r\n       for(let i = 0; i < keys.length; i++){\r\n        let key = keys[i]\r\n        let value = data[key]\r\n        defineReactive(data, key, value)\r\n       }\r\n    }\r\n}\r\nfunction defineReactive(data,key,value){\r\n    observe(value)\r\n    Object.defineProperty(data, key, {\r\n        get(){\r\n            return value\r\n        },\r\n        set(newValue){\r\n            if(newValue === value) return \r\n            observe(newValue)\r\n            value = newValue\r\n\r\n        }\r\n    })\r\n}\r\nexport function observe(data){\r\n   let isObj = isObject(data)\r\n   if(!isObj){\r\n    return\r\n   }\r\n   new Observe(data)\r\n}","import { observe } from './observe/index.js'\r\nexport function initState(vm) {\r\n    const opts = vm.$options\r\n    // vue的数据来源 属性 方法 数据 计算属性 watch\r\n    if(opts.props){\r\n        initProps(vm)\r\n    }\r\n    if(opts.methods){\r\n        initMethods(vm)\r\n    }\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n    if(opts.computed){\r\n        initComputed(vm)\r\n    }\r\n    if(opts.watch){\r\n        initWatch(vm)\r\n    }\r\n}\r\n\r\nfunction initProps(vm) {\r\n}\r\nfunction initMethods(vm) {\r\n}\r\nfunction initData(vm) {\r\n    let data = vm.$options.data\r\n    data = typeof data === 'function' ? data.call(vm) : data\r\n    // 对象劫持 用户改变数据我希望可以得到通知 => 刷新页面\r\n    // Object.defineProperty\r\n    observe(data)\r\n}\r\nfunction initComputed(vm) {\r\n}\r\nfunction initWatch(vm) {\r\n}","\r\nimport { compileToFunction } from \"./compile/index.js\";\r\nimport { initState } from \"./initState\"\r\nexport function initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        const vm = this\r\n        vm.$options = options || {}\r\n\r\n        initState(vm)\r\n\r\n\r\n        // 如果用户传入了el属性就要渲染出来\r\n        if(vm.$options.el){\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n    Vue.prototype.$mount = function(el){\r\n        const vm = this\r\n        const options = vm.$options\r\n        el = document.querySelector(el)\r\n        // 默认查找render方法 没有会采用template 没有就用el中的内容\r\n        if(!options.render){\r\n            // 对模板进行编译\r\n            let template = options.template\r\n            if(!template && el){\r\n                template = el.outerHTML            \r\n            }\r\n            // template转化为render方法\r\n            const render = compileToFunction(template)\r\n        }\r\n    }\r\n}","import { initMixin } from \"./init\";\r\nfunction Vue(options){\r\n    this._init(options);\r\n}\r\n\r\n// 通过引入文件的方式 给Vue原型上添加方法\r\ninitMixin(Vue)\r\nexport default Vue\r\n"],"names":["oldArrayMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","_len","arguments","length","args","_key","result","apply","inserted","ob","__ob__","slice","observeArray","isObject","data","_typeof","def","key","value","defineProperty","enumerable","configurable","Observe","_classCallCheck","isArray","__proto__","walk","_createClass","i","observe","keys","defineReactive","get","set","newValue","isObj","initState","vm","opts","$options","props","initData","computed","watch","call","initMixin","Vue","_init","options","el","$mount","document","querySelector","render","template","outerHTML"],"mappings":"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"}